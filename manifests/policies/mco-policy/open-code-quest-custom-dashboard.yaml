kind: ConfigMap
apiVersion: v1
metadata:
  name: open-code-quest
  namespace: open-cluster-management-observability
  labels:
    grafana-custom-dashboard: "true"
data:
  open-code-quest.json: |
    {"annotations": {"list": [{"builtIn": 1, "datasource": {"type": "grafana", "uid": "-- Grafana --"}, "enable": true, "hide": true, "iconColor": "rgba(0, 211, 255, 1)", "name": "Annotations & Alerts", "type": "dashboard"}]}, "editable": true, "fiscalYearStartMonth": 0, "graphTooltip": 0, "id": 58, "links": [], "panels": [{"datasource": {"type": "prometheus", "uid": "000000001"}, "fieldConfig": {"defaults": {"color": {"mode": "thresholds"}, "mappings": [], "max": 1, "min": 0, "thresholds": {"mode": "absolute", "steps": [{"color": "green"}, {"color": "red", "value": 80}]}, "unit": "percentunit"}, "overrides": []}, "gridPos": {"h": 3, "w": 12, "x": 0, "y": 0}, "id": 2, "options": {"colorMode": "value", "graphMode": "area", "justifyMode": "auto", "orientation": "auto", "percentChangeColorMode": "standard", "reduceOptions": {"calcs": ["mean"], "fields": "", "values": false}, "showPercentChange": false, "textMode": "auto", "wideLayout": true}, "pluginVersion": "11.6.1", "targets": [{"disableTextWrap": false, "editorMode": "code", "expr": "1 - avg by(cluster) (rate(node_cpu_seconds_total{mode=\"idle\", cluster=\"$cluster\"}[$__rate_interval]))", "fullMetaSearch": false, "includeNullMetadata": true, "legendFormat": "__auto", "range": true, "refId": "A", "useBackend": false}], "title": "Utilisation CPU ", "type": "stat"}, {"datasource": {"type": "prometheus", "uid": "000000001"}, "fieldConfig": {"defaults": {"color": {"mode": "thresholds"}, "mappings": [], "max": 1, "min": 0, "thresholds": {"mode": "absolute", "steps": [{"color": "green"}, {"color": "red", "value": 80}]}, "unit": "percentunit"}, "overrides": []}, "gridPos": {"h": 3, "w": 12, "x": 12, "y": 0}, "id": 3, "options": {"colorMode": "value", "graphMode": "area", "justifyMode": "auto", "orientation": "auto", "percentChangeColorMode": "standard", "reduceOptions": {"calcs": ["mean"], "fields": "", "values": false}, "showPercentChange": false, "textMode": "auto", "wideLayout": true}, "pluginVersion": "11.6.1", "targets": [{"editorMode": "code", "expr": "1- (sum by (cluster)(\n  :node_memory_MemAvailable_bytes:sum{cluster=\"$cluster\"}\n)\n/\nsum by (cluster)(\n  kube_node_status_allocatable{cluster=\"$cluster\" , resource=\"memory\"}\n))\n", "legendFormat": "__auto", "range": true, "refId": "A"}], "title": "Utilisation m\u00e9moire", "type": "stat"}, {"datasource": {"type": "prometheus", "uid": "000000001"}, "fieldConfig": {"defaults": {"custom": {"align": "auto", "cellOptions": {"type": "auto"}, "inspect": false}, "mappings": [], "thresholds": {"mode": "absolute", "steps": [{"color": "green"}, {"color": "orange", "value": 10}, {"color": "red", "value": 20}]}}, "overrides": [{"matcher": {"id": "byName", "options": "Value #A"}, "properties": [{"id": "displayName", "value": "Nombre de pods"}]}, {"matcher": {"id": "byName", "options": "Value #B"}, "properties": [{"id": "displayName", "value": "Nombre d'utilisateurs"}]}, {"matcher": {"id": "byName", "options": "Value #C"}, "properties": [{"id": "displayName", "value": "Nombre de templates"}]}, {"matcher": {"id": "byName", "options": "Value #D"}, "properties": [{"id": "displayName", "value": "Nombre de composants"}]}]}, "gridPos": {"h": 7, "w": 24, "x": 0, "y": 3}, "id": 29, "options": {"cellHeight": "sm", "footer": {"countRows": false, "fields": "", "reducer": ["sum"], "show": false}, "frameIndex": 0, "showHeader": true, "sortBy": [{"desc": true, "displayName": "Nombre de pods"}]}, "pluginVersion": "11.6.1", "targets": [{"editorMode": "code", "expr": "sum by (namespace) (kube_pod_owner{cluster=\"$cluster\", namespace=~\".*rhdh-team.*\"})", "format": "table", "instant": true, "legendFormat": "{{namespace}}", "refId": "A"}, {"datasource": {"type": "prometheus", "uid": "000000001"}, "editorMode": "code", "expr": "max by (namespace) (catalog_entities_count{kind=\"user\", cluster=\"$cluster\", namespace=~\"rhdh-team.*\"})", "format": "table", "hide": false, "instant": true, "legendFormat": "{{namespace}}", "refId": "B"}, {"datasource": {"type": "prometheus", "uid": "000000001"}, "editorMode": "code", "expr": "max by (namespace) (catalog_entities_count{kind=\"template\", cluster=\"$cluster\", namespace=~\"rhdh-team.*\"})", "format": "table", "hide": false, "instant": true, "legendFormat": "{{namespace}}", "refId": "C"}, {"datasource": {"type": "prometheus", "uid": "000000001"}, "editorMode": "code", "expr": "max by (namespace) (catalog_entities_count{kind=\"component\", cluster=\"$cluster\", namespace=~\"rhdh-team.*\"})", "format": "table", "hide": false, "instant": true, "legendFormat": "{{namespace}}", "refId": "D"}], "title": "M\u00e9triques RHDH (rhdh-team)", "transformations": [{"id": "organize", "options": {"excludeByName": {"Time": true}, "includeByName": {}, "indexByName": {}, "renameByName": {"Namespace": "Namespace", "Nombre de pods": "Nombre de pods", "Value": "Nombre de pods", "namespace": "Namespace"}}}, {"id": "joinByField", "options": {"byField": "Namespace", "mode": "outer"}}], "type": "table"}], "preload": false, "schemaVersion": 41, "tags": [], "templating": {"list": [{"current": {"text": "local-cluster", "value": "local-cluster"}, "definition": "label_values(acm_managed_cluster_labels,name)", "name": "cluster", "options": [], "query": {"qryType": 1, "query": "label_values(acm_managed_cluster_labels,name)", "refId": "PrometheusVariableQueryEditor-VariableQuery"}, "refresh": 1, "regex": "", "type": "query"}]}, "time": {"from": "now-6h", "to": "now"}, "timepicker": {}, "timezone": "browser", "title": "Open Code Quest", "version": 7}
