kind: ConfigMap
apiVersion: v1
metadata:
  name: open-code-quest
  namespace: open-cluster-management-observability
  labels:
    grafana-custom-dashboard: "true"
data:
  open-code-quest.json: |
    { "annotations": { "list": [ { "builtIn": 1, "datasource": { "type": "grafana", "uid": "-- Grafana --" }, "enable": true, "hide": true, "iconColor": "rgba(0, 211, 255, 1)", "name": "Annotations & Alerts", "type": "dashboard" } ] }, "editable": true, "fiscalYearStartMonth": 0, "graphTooltip": 0, "id": 60, "links": [], "panels": [ { "datasource": { "type": "prometheus", "uid": "000000001" }, "description": "Nombre d’équipes ayant terminé l’étape 'import des utilisateurs'", "fieldConfig": { "defaults": { "color": { "fixedColor": "green", "mode": "palette-classic" }, "mappings": [], "max": 23, "min": 0, "noValue": "0", "thresholds": { "mode": "absolute", "steps": [ { "color": "red" } ] }, "unit": "none" }, "overrides": [ { "matcher": { "id": "byFrameRefID", "options": "A" }, "properties": [ { "id": "displayName", "value": "Entité utilisateur" } ] }, { "matcher": { "id": "byFrameRefID", "options": "B" }, "properties": [ { "id": "displayName", "value": "Entité template" } ] }, { "matcher": { "id": "byFrameRefID", "options": "C" }, "properties": [ { "id": "displayName", "value": "Entité component" } ] }, { "matcher": { "id": "byFrameRefID", "options": "D" }, "properties": [ { "id": "displayName", "value": "Pod hero-dev" } ] }, { "matcher": { "id": "byFrameRefID", "options": "E" }, "properties": [ { "id": "displayName", "value": "Pod hero-preprod" } ] }, { "matcher": { "id": "byFrameRefID", "options": "F" }, "properties": [ { "id": "displayName", "value": "Pod hero-prod" } ] }, { "matcher": { "id": "byFrameRefID", "options": "G" }, "properties": [ { "id": "displayName", "value": "Pod villain-dev" } ] }, { "matcher": { "id": "byFrameRefID", "options": "H" }, "properties": [ { "id": "displayName", "value": "Pod villain-preprod" } ] }, { "matcher": { "id": "byFrameRefID", "options": "I" }, "properties": [ { "id": "displayName", "value": "Pod villain-prod" } ] }, { "matcher": { "id": "byFrameRefID", "options": "J" }, "properties": [ { "id": "displayName", "value": "Pod fight-dev" } ] }, { "matcher": { "id": "byFrameRefID", "options": "K" }, "properties": [ { "id": "displayName", "value": "Pod fight-preprod" } ] }, { "matcher": { "id": "byFrameRefID", "options": "L" }, "properties": [ { "id": "displayName", "value": "fight-prod" } ] } ] }, "gridPos": { "h": 12, "w": 24, "x": 0, "y": 0 }, "id": 60, "options": { "displayMode": "lcd", "legend": { "calcs": [], "displayMode": "list", "placement": "bottom", "showLegend": false }, "maxVizHeight": 300, "minVizHeight": 82, "minVizWidth": 8, "namePlacement": "left", "orientation": "horizontal", "reduceOptions": { "calcs": [ "lastNotNull" ], "fields": "", "values": false }, "showUnfilled": true, "sizing": "auto", "valueMode": "color" }, "pluginVersion": "11.6.1", "targets": [ { "editorMode": "code", "expr": "max((count(catalog_entities_count{kind=\"user\", namespace=~\"rhdh-team[0-9]+\"} == 35)) or on() vector(0))", "legendFormat": "__auto", "range": true, "refId": "A" }, { "datasource": { "type": "prometheus", "uid": "000000001" }, "editorMode": "code", "expr": "max((count(catalog_entities_count{kind=\"template\", namespace=~\"rhdh-team[0-9]+\"} == 4))  or on() vector(0))", "hide": false, "instant": false, "legendFormat": "__auto", "range": true, "refId": "B" }, { "datasource": { "type": "prometheus", "uid": "000000001" }, "editorMode": "code", "expr": "max((count(catalog_entities_count{kind=\"component\", namespace=~\"rhdh-team[0-9]+\"} == 4))  or on() vector(0))", "hide": false, "instant": false, "legendFormat": "__auto", "range": true, "refId": "C" }, { "datasource": { "type": "prometheus", "uid": "000000001" }, "editorMode": "code", "expr": "max((count(kube_pod_info{\n    namespace=~\"devteam[0-9]+-workshop-dev\",\n    pod=~\"hero-.*\",\n    pod!~\".*database.*\",\n    created_by_kind=\"ReplicaSet\"}) > 0) or on() vector(0))", "hide": false, "instant": false, "legendFormat": "__auto", "range": true, "refId": "D" }, { "datasource": { "type": "prometheus", "uid": "000000001" }, "editorMode": "code", "expr": "max((count(kube_pod_info{\n    namespace=~\"devteam[0-9]+-workshop-preprod\",\n    pod=~\"hero-.*\",\n    pod!~\".*database.*\",\n    created_by_kind=\"ReplicaSet\"}) > 0) or on() vector(0))", "hide": false, "instant": false, "legendFormat": "__auto", "range": true, "refId": "E" }, { "datasource": { "type": "prometheus", "uid": "000000001" }, "editorMode": "code", "expr": "max((count(kube_pod_info{\n    namespace=~\"devteam[0-9]+-workshop-prod\",\n    pod=~\"hero-.*\",\n    pod!~\".*database.*\",\n    created_by_kind=\"ReplicaSet\"}) > 0) or on() vector(0))", "hide": false, "instant": false, "legendFormat": "__auto", "range": true, "refId": "F" }, { "datasource": { "type": "prometheus", "uid": "000000001" }, "editorMode": "code", "expr": "max((count(kube_pod_info{\n    namespace=~\"devteam[0-9]+-workshop-dev\",\n    pod=~\"villain-.*\",\n    pod!~\".*database.*\",\n    created_by_kind=\"ReplicaSet\"}) > 0) or on() vector(0))", "hide": false, "instant": false, "legendFormat": "__auto", "range": true, "refId": "G" }, { "datasource": { "type": "prometheus", "uid": "000000001" }, "editorMode": "code", "expr": "max((count(kube_pod_info{\n    namespace=~\"devteam[0-9]+-workshop-preprod\",\n    pod=~\"villain-.*\",\n    pod!~\".*database.*\",\n    created_by_kind=\"ReplicaSet\"}) > 0) or on() vector(0))", "hide": false, "instant": false, "legendFormat": "__auto", "range": true, "refId": "H" }, { "datasource": { "type": "prometheus", "uid": "000000001" }, "editorMode": "code", "expr": "max((count(kube_pod_info{\n    namespace=~\"devteam[0-9]+-workshop-prod\",\n    pod=~\"villain-.*\",\n    pod!~\".*database.*\",\n    created_by_kind=\"ReplicaSet\"}) > 0) or on() vector(0))", "hide": false, "instant": false, "legendFormat": "__auto", "range": true, "refId": "I" }, { "datasource": { "type": "prometheus", "uid": "000000001" }, "editorMode": "code", "expr": "max((count(kube_pod_info{\n    namespace=~\"devteam[0-9]+-workshop-dev\",\n    pod=~\"fight-.*\",\n    pod!~\".*database.*|fight-ui.*\",\n    created_by_kind=\"ReplicaSet\"}) > 0) or on() vector(0))", "hide": false, "instant": false, "legendFormat": "__auto", "range": true, "refId": "J" }, { "datasource": { "type": "prometheus", "uid": "000000001" }, "editorMode": "code", "expr": "max((count(kube_pod_info{\n    namespace=~\"devteam[0-9]+-workshop-preprod\",\n    pod=~\"fight-.*\",\n    pod!~\".*database.*|fight-ui.*\",\n    created_by_kind=\"ReplicaSet\"}) > 0) or on() vector(0))", "hide": false, "instant": false, "legendFormat": "__auto", "range": true, "refId": "K" }, { "datasource": { "type": "prometheus", "uid": "000000001" }, "editorMode": "code", "expr": "max((count(kube_pod_info{\n    namespace=~\"devteam[0-9]+-workshop-prod\",\n    pod=~\"fight-.*\",\n    pod!~\".*database.*|fight-ui.*\",\n    created_by_kind=\"ReplicaSet\"}) > 0) or on() vector(0))", "hide": false, "instant": false, "legendFormat": "__auto", "range": true, "refId": "L" } ], "title": "Etat d'avancement de toutes les équipes - 5 clusters de 5 équipes (Total 25)", "type": "bargauge" }, { "collapsed": false, "gridPos": { "h": 1, "w": 24, "x": 0, "y": 12 }, "id": 56, "panels": [], "title": "Progression des équipes dans le déploiement des entités RHDH - $cluster", "type": "row" }, { "datasource": { "type": "prometheus", "uid": "000000001" }, "description": "Nombre d’équipes ayant terminé l’étape 'import des utilisateurs'", "fieldConfig": { "defaults": { "color": { "mode": "thresholds" }, "mappings": [], "max": 5, "min": 0, "noValue": "0", "thresholds": { "mode": "absolute", "steps": [ { "color": "red" }, { "color": "yellow", "value": 1 }, { "color": "green", "value": 4 } ] }, "unit": "none" }, "overrides": [] }, "gridPos": { "h": 7, "w": 8, "x": 0, "y": 13 }, "id": 53, "options": { "minVizHeight": 75, "minVizWidth": 75, "orientation": "auto", "reduceOptions": { "calcs": [ "lastNotNull" ], "fields": "", "values": false }, "showThresholdLabels": false, "showThresholdMarkers": true, "sizing": "auto" }, "pluginVersion": "11.6.1", "targets": [ { "editorMode": "code", "expr": "count(catalog_entities_count{kind=\"user\", cluster=\"$cluster\", namespace=~\"rhdh-team[0-9]+\"} == 35)", "legendFormat": "__auto", "range": true, "refId": "A" } ], "title": "Entité utilisateur", "type": "gauge" }, { "datasource": { "type": "prometheus", "uid": "000000001" }, "description": "Nombre d’équipes ayant terminé l’étape 'import des templates'", "fieldConfig": { "defaults": { "color": { "mode": "thresholds" }, "mappings": [], "max": 5, "min": 0, "noValue": "0", "thresholds": { "mode": "absolute", "steps": [ { "color": "red" }, { "color": "yellow", "value": 1 }, { "color": "green", "value": 4 } ] }, "unit": "none" }, "overrides": [] }, "gridPos": { "h": 7, "w": 8, "x": 8, "y": 13 }, "id": 54, "options": { "minVizHeight": 75, "minVizWidth": 75, "orientation": "auto", "reduceOptions": { "calcs": [ "lastNotNull" ], "fields": "", "values": false }, "showThresholdLabels": false, "showThresholdMarkers": true, "sizing": "auto" }, "pluginVersion": "11.6.1", "targets": [ { "editorMode": "code", "expr": "count(catalog_entities_count{kind=\"template\", cluster=\"$cluster\", namespace=~\"rhdh-team[0-9]+\"} == 4)", "legendFormat": "__auto", "range": true, "refId": "A" } ], "title": "Entité template", "type": "gauge" }, { "datasource": { "type": "prometheus", "uid": "000000001" }, "description": "Nombre d’équipes ayant terminé l’étape 'import des components'", "fieldConfig": { "defaults": { "color": { "mode": "thresholds" }, "mappings": [], "max": 5, "min": 0, "noValue": "0", "thresholds": { "mode": "absolute", "steps": [ { "color": "red" }, { "color": "yellow", "value": 1 }, { "color": "green", "value": 4 } ] }, "unit": "none" }, "overrides": [] }, "gridPos": { "h": 7, "w": 8, "x": 16, "y": 13 }, "id": 55, "options": { "minVizHeight": 75, "minVizWidth": 75, "orientation": "auto", "reduceOptions": { "calcs": [ "lastNotNull" ], "fields": "", "values": false }, "showThresholdLabels": false, "showThresholdMarkers": true, "sizing": "auto" }, "pluginVersion": "11.6.1", "targets": [ { "editorMode": "code", "expr": "count(catalog_entities_count{kind=\"component\", cluster=\"$cluster\", namespace=~\"rhdh-team[0-9]+\"} == 4)", "legendFormat": "__auto", "range": true, "refId": "A" } ], "title": "Entités component", "type": "gauge" }, { "datasource": { "type": "prometheus", "uid": "000000001" }, "fieldConfig": { "defaults": { "custom": { "align": "auto", "cellOptions": { "type": "auto" }, "inspect": false }, "mappings": [], "thresholds": { "mode": "absolute", "steps": [ { "color": "green" }, { "color": "orange", "value": 10 }, { "color": "red", "value": 20 } ] } }, "overrides": [ { "matcher": { "id": "byName", "options": "Value #A" }, "properties": [ { "id": "displayName", "value": "Nombre de pods" } ] }, { "matcher": { "id": "byName", "options": "Value #B" }, "properties": [ { "id": "displayName", "value": "Nombre d'utilisateurs" } ] }, { "matcher": { "id": "byName", "options": "Value #C" }, "properties": [ { "id": "displayName", "value": "Nombre de templates" } ] }, { "matcher": { "id": "byName", "options": "Value #D" }, "properties": [ { "id": "displayName", "value": "Nombre de composants" } ] } ] }, "gridPos": { "h": 0, "w": 24, "x": 0, "y": 20 }, "id": 57, "options": { "cellHeight": "sm", "footer": { "countRows": false, "fields": "", "reducer": [ "sum" ], "show": false }, "frameIndex": 0, "showHeader": true, "sortBy": [ { "desc": true, "displayName": "Nombre de pods" } ] }, "pluginVersion": "11.6.1", "repeat": "cluster", "repeatDirection": "h", "targets": [ { "editorMode": "code", "expr": "sum by (namespace) (kube_pod_owner{cluster=\"$cluster\", namespace=~\".*rhdh-team.*\"})", "format": "table", "instant": true, "legendFormat": "{{namespace}}", "refId": "A" }, { "datasource": { "type": "prometheus", "uid": "000000001" }, "editorMode": "code", "expr": "max by (namespace) (catalog_entities_count{kind=\"user\", cluster=\"$cluster\", namespace=~\"rhdh-team.*\"})", "format": "table", "hide": false, "instant": true, "legendFormat": "{{namespace}}", "refId": "B" }, { "datasource": { "type": "prometheus", "uid": "000000001" }, "editorMode": "code", "expr": "max by (namespace) (catalog_entities_count{kind=\"template\", cluster=\"$cluster\", namespace=~\"rhdh-team.*\"})", "format": "table", "hide": false, "instant": true, "legendFormat": "{{namespace}}", "refId": "C" }, { "datasource": { "type": "prometheus", "uid": "000000001" }, "editorMode": "code", "expr": "max by (namespace) (catalog_entities_count{kind=\"component\", cluster=\"$cluster\", namespace=~\"rhdh-team.*\"})", "format": "table", "hide": false, "instant": true, "legendFormat": "{{namespace}}", "refId": "D" } ], "title": "Métriques RHDH (rhdh-team)", "transformations": [ { "id": "organize", "options": { "excludeByName": { "Time": true }, "includeByName": {}, "indexByName": {}, "renameByName": { "Namespace": "Namespace", "Nombre de pods": "Nombre de pods", "Value": "Nombre de pods", "namespace": "Namespace" } } }, { "id": "joinByField", "options": { "byField": "Namespace", "mode": "outer" } } ], "type": "table" }, { "collapsed": false, "gridPos": { "h": 1, "w": 24, "x": 0, "y": 20 }, "id": 40, "panels": [], "repeat": "team", "title": "État des déploiements $team - $cluster", "type": "row" }, { "fieldConfig": { "defaults": {}, "overrides": [] }, "gridPos": { "h": 2, "w": 2, "x": 0, "y": 21 }, "id": 41, "options": { "code": { "language": "plaintext", "showLineNumbers": false, "showMiniMap": false }, "content": "<p style=\"text-align: center; padding-top: 1em; text-transform: capitalize;\">\n  ${team}\n</p>", "mode": "html" }, "pluginVersion": "11.6.1", "title": "", "type": "text" }, { "datasource": { "uid": "000000001" }, "fieldConfig": { "defaults": { "color": { "fixedColor": "green", "mode": "thresholds" }, "decimals": 0, "mappings": [ { "options": { "from": 1, "result": { "color": "green", "index": 0, "text": "hero-dev" }, "to": 9999 }, "type": "range" } ], "noValue": "hero-dev", "thresholds": { "mode": "absolute", "steps": [ { "color": "red" } ] } }, "overrides": [] }, "gridPos": { "h": 2, "w": 2, "x": 2, "y": 21 }, "id": 38, "options": { "colorMode": "background_solid", "graphMode": "none", "justifyMode": "center", "orientation": "auto", "percentChangeColorMode": "standard", "reduceOptions": { "calcs": [ "lastNotNull" ], "fields": "", "values": false }, "showPercentChange": false, "text": { "percentSize": 0, "valueSize": 14 }, "textMode": "value", "wideLayout": true }, "pluginVersion": "11.6.1", "targets": [ { "editorMode": "code", "expr": "count(kube_pod_info{\n    cluster= \"$cluster\",\n    namespace=~\"dev$team-workshop-dev\",\n    pod=~\"hero-.*\",\n    pod!~\".*database.*\",\n    created_by_kind=\"ReplicaSet\"}) > 0", "legendFormat": "__auto", "range": true, "refId": "A" } ], "title": "", "type": "stat" }, { "datasource": { "uid": "000000001" }, "fieldConfig": { "defaults": { "color": { "fixedColor": "green", "mode": "thresholds" }, "decimals": 0, "mappings": [ { "options": { "from": 1, "result": { "index": 0, "text": "hero-preprod" }, "to": 9999 }, "type": "range" } ], "noValue": "hero-preprod", "thresholds": { "mode": "absolute", "steps": [ { "color": "red" }, { "color": "green", "value": 1 } ] } }, "overrides": [] }, "gridPos": { "h": 2, "w": 2, "x": 4, "y": 21 }, "id": 42, "options": { "colorMode": "background_solid", "graphMode": "none", "justifyMode": "center", "orientation": "auto", "percentChangeColorMode": "standard", "reduceOptions": { "calcs": [ "lastNotNull" ], "fields": "", "values": false }, "showPercentChange": false, "text": { "percentSize": 0, "valueSize": 14 }, "textMode": "value", "wideLayout": true }, "pluginVersion": "11.6.1", "targets": [ { "editorMode": "code", "expr": "count(kube_pod_info{\n    cluster= \"$cluster\",\n    namespace=~\"dev$team-workshop-preprod\",\n    pod=~\"hero-.*\",\n    pod!~\".*database.*\",\n    created_by_kind=\"ReplicaSet\"}) > 0", "legendFormat": "__auto", "range": true, "refId": "A" } ], "title": "", "type": "stat" }, { "datasource": { "uid": "000000001" }, "fieldConfig": { "defaults": { "color": { "fixedColor": "green", "mode": "thresholds" }, "decimals": 0, "mappings": [ { "options": { "from": 0, "result": { "color": "green", "index": 0, "text": "hero-prod" }, "to": 9999 }, "type": "range" } ], "noValue": "hero-prod", "thresholds": { "mode": "absolute", "steps": [ { "color": "red" } ] } }, "overrides": [] }, "gridPos": { "h": 2, "w": 2, "x": 6, "y": 21 }, "id": 43, "options": { "colorMode": "background_solid", "graphMode": "none", "justifyMode": "center", "orientation": "auto", "percentChangeColorMode": "standard", "reduceOptions": { "calcs": [ "lastNotNull" ], "fields": "", "values": false }, "showPercentChange": false, "text": { "percentSize": 0, "valueSize": 14 }, "textMode": "value", "wideLayout": true }, "pluginVersion": "11.6.1", "targets": [ { "editorMode": "code", "expr": "count(kube_pod_info{\n    cluster= \"$cluster\",\n    namespace=~\"dev$team-workshop-prod\",\n    pod=~\"hero-.*\",\n    pod!~\".*database.*\",\n    created_by_kind=\"ReplicaSet\"}) > 0", "legendFormat": "__auto", "range": true, "refId": "A" } ], "title": "", "type": "stat" }, { "datasource": { "uid": "000000001" }, "fieldConfig": { "defaults": { "color": { "fixedColor": "green", "mode": "thresholds" }, "decimals": 0, "mappings": [ { "options": { "from": 1, "result": { "color": "green", "index": 0, "text": "villain-dev" }, "to": 9999 }, "type": "range" } ], "noValue": "villain-dev", "thresholds": { "mode": "absolute", "steps": [ { "color": "red" } ] } }, "overrides": [] }, "gridPos": { "h": 2, "w": 2, "x": 10, "y": 21 }, "id": 59, "options": { "colorMode": "background_solid", "graphMode": "none", "justifyMode": "center", "orientation": "auto", "percentChangeColorMode": "standard", "reduceOptions": { "calcs": [ "lastNotNull" ], "fields": "", "values": false }, "showPercentChange": false, "text": { "percentSize": 0, "valueSize": 14 }, "textMode": "value", "wideLayout": true }, "pluginVersion": "11.6.1", "targets": [ { "editorMode": "code", "expr": "count(kube_pod_info{\n    cluster= \"$cluster\",\n    namespace=~\"dev$team-workshop-dev\",\n    pod=~\"villain-.*\",\n    pod!~\".*database.*\",\n    created_by_kind=\"ReplicaSet\"}) > 0", "legendFormat": "__auto", "range": true, "refId": "A" } ], "title": "", "type": "stat" }, { "datasource": { "uid": "000000001" }, "fieldConfig": { "defaults": { "color": { "fixedColor": "green", "mode": "thresholds" }, "decimals": 0, "mappings": [ { "options": { "from": 1, "result": { "color": "green", "index": 0, "text": "villain-preprod" }, "to": 9999 }, "type": "range" } ], "noValue": "villain-preprod", "thresholds": { "mode": "absolute", "steps": [ { "color": "red" } ] } }, "overrides": [] }, "gridPos": { "h": 2, "w": 2, "x": 12, "y": 21 }, "id": 45, "options": { "colorMode": "background_solid", "graphMode": "none", "justifyMode": "center", "orientation": "auto", "percentChangeColorMode": "standard", "reduceOptions": { "calcs": [ "lastNotNull" ], "fields": "", "values": false }, "showPercentChange": false, "text": { "percentSize": 0, "valueSize": 14 }, "textMode": "value", "wideLayout": true }, "pluginVersion": "11.6.1", "targets": [ { "editorMode": "code", "expr": "count(kube_pod_info{\n    cluster= \"$cluster\",\n    namespace=~\"dev$team-workshop-preprod\",\n    pod=~\"villain-.*\",\n    pod!~\".*database.*\",\n    created_by_kind=\"ReplicaSet\"}) > 0", "legendFormat": "__auto", "range": true, "refId": "A" } ], "title": "", "type": "stat" }, { "datasource": { "uid": "000000001" }, "fieldConfig": { "defaults": { "color": { "fixedColor": "green", "mode": "thresholds" }, "decimals": 0, "mappings": [ { "options": { "from": 1, "result": { "color": "green", "index": 0, "text": "villain-prod" }, "to": 9999 }, "type": "range" } ], "noValue": "villain-prod", "thresholds": { "mode": "absolute", "steps": [ { "color": "red" } ] } }, "overrides": [] }, "gridPos": { "h": 2, "w": 2, "x": 14, "y": 21 }, "id": 50, "options": { "colorMode": "background_solid", "graphMode": "none", "justifyMode": "center", "orientation": "auto", "percentChangeColorMode": "standard", "reduceOptions": { "calcs": [ "lastNotNull" ], "fields": "", "values": false }, "showPercentChange": false, "text": { "percentSize": 0, "valueSize": 14 }, "textMode": "value", "wideLayout": true }, "pluginVersion": "11.6.1", "targets": [ { "editorMode": "code", "expr": "count(kube_pod_info{\n    cluster= \"$cluster\",\n    namespace=~\"dev$team-workshop-prod\",\n    pod=~\"villain-.*\",\n    pod!~\".*database.*\",\n    created_by_kind=\"ReplicaSet\"}) > 0", "legendFormat": "__auto", "range": true, "refId": "A" } ], "title": "", "type": "stat" }, { "datasource": { "uid": "000000001" }, "fieldConfig": { "defaults": { "color": { "fixedColor": "green", "mode": "thresholds" }, "decimals": 0, "mappings": [ { "options": { "from": 1, "result": { "color": "green", "index": 0, "text": "fight-dev" }, "to": 9999 }, "type": "range" } ], "noValue": "fight-dev", "thresholds": { "mode": "absolute", "steps": [ { "color": "red" } ] } }, "overrides": [] }, "gridPos": { "h": 2, "w": 2, "x": 18, "y": 21 }, "id": 47, "options": { "colorMode": "background_solid", "graphMode": "none", "justifyMode": "center", "orientation": "auto", "percentChangeColorMode": "standard", "reduceOptions": { "calcs": [ "lastNotNull" ], "fields": "", "values": false }, "showPercentChange": false, "text": { "percentSize": 0, "valueSize": 14 }, "textMode": "value", "wideLayout": true }, "pluginVersion": "11.6.1", "targets": [ { "editorMode": "code", "expr": "count(kube_pod_info{\n    cluster= \"$cluster\",\n    namespace=~\"dev$team-workshop-dev\",\n    pod=~\"fight-.*\",\n    pod!~\".*database.*|fight-ui.*\",\n    created_by_kind=\"ReplicaSet\"}) > 0", "legendFormat": "__auto", "range": true, "refId": "A" } ], "title": "", "type": "stat" }, { "datasource": { "uid": "000000001" }, "fieldConfig": { "defaults": { "color": { "fixedColor": "green", "mode": "thresholds" }, "decimals": 0, "mappings": [ { "options": { "from": 1, "result": { "color": "green", "index": 0, "text": "fight-preprod" }, "to": 9999 }, "type": "range" } ], "noValue": "fight-preprod", "thresholds": { "mode": "absolute", "steps": [ { "color": "red" } ] } }, "overrides": [] }, "gridPos": { "h": 2, "w": 2, "x": 20, "y": 21 }, "id": 51, "options": { "colorMode": "background_solid", "graphMode": "none", "justifyMode": "center", "orientation": "auto", "percentChangeColorMode": "standard", "reduceOptions": { "calcs": [ "lastNotNull" ], "fields": "", "values": false }, "showPercentChange": false, "text": { "percentSize": 0, "valueSize": 14 }, "textMode": "value", "wideLayout": true }, "pluginVersion": "11.6.1", "targets": [ { "editorMode": "code", "expr": "count(kube_pod_info{\n    cluster= \"$cluster\",\n    namespace=~\"dev$team-workshop-preprod\",\n    pod=~\"fight-.*\",\n    pod!~\".*database.*|fight-ui.*\",\n    created_by_kind=\"ReplicaSet\"}) > 0 ", "legendFormat": "__auto", "range": true, "refId": "A" } ], "title": "", "type": "stat" }, { "datasource": { "uid": "000000001" }, "fieldConfig": { "defaults": { "color": { "fixedColor": "green", "mode": "thresholds" }, "decimals": 0, "mappings": [ { "options": { "1": { "color": "green", "index": 0, "text": "fight-prod" } }, "type": "value" } ], "noValue": "fight-prod", "thresholds": { "mode": "absolute", "steps": [ { "color": "red" } ] } }, "overrides": [] }, "gridPos": { "h": 2, "w": 2, "x": 22, "y": 21 }, "id": 52, "options": { "colorMode": "background_solid", "graphMode": "none", "justifyMode": "center", "orientation": "auto", "percentChangeColorMode": "standard", "reduceOptions": { "calcs": [ "lastNotNull" ], "fields": "", "values": false }, "showPercentChange": false, "text": { "percentSize": 0, "valueSize": 14 }, "textMode": "value", "wideLayout": true }, "pluginVersion": "11.6.1", "targets": [ { "editorMode": "code", "expr": "kube_pod_info{\n    cluster= \"$cluster\",\n    namespace=~\"dev$team-workshop-prod\",\n    pod=~\"fight-.*\",\n    pod!~\".*database.*|fight-ui.*\",\n    created_by_kind=\"ReplicaSet\"}", "legendFormat": "__auto", "range": true, "refId": "A" } ], "title": "", "type": "stat" }, { "collapsed": false, "gridPos": { "h": 1, "w": 24, "x": 0, "y": 35 }, "id": 58, "panels": [], "title": "Suivi détaillé du déploiement des entités RHDH - $cluster", "type": "row" }, { "datasource": { "type": "prometheus", "uid": "000000001" }, "fieldConfig": { "defaults": { "custom": { "align": "auto", "cellOptions": { "type": "auto" }, "inspect": false }, "mappings": [], "thresholds": { "mode": "absolute", "steps": [ { "color": "green" }, { "color": "orange", "value": 10 }, { "color": "red", "value": 20 } ] } }, "overrides": [ { "matcher": { "id": "byName", "options": "Value #A" }, "properties": [ { "id": "displayName", "value": "Nombre de pods" } ] }, { "matcher": { "id": "byName", "options": "Value #B" }, "properties": [ { "id": "displayName", "value": "Nombre d'utilisateurs" } ] }, { "matcher": { "id": "byName", "options": "Value #C" }, "properties": [ { "id": "displayName", "value": "Nombre de templates" } ] }, { "matcher": { "id": "byName", "options": "Value #D" }, "properties": [ { "id": "displayName", "value": "Nombre de composants" } ] } ] }, "gridPos": { "h": 7, "w": 24, "x": 0, "y": 36 }, "id": 29, "options": { "cellHeight": "sm", "footer": { "countRows": false, "fields": "", "reducer": [ "sum" ], "show": false }, "frameIndex": 0, "showHeader": true, "sortBy": [ { "desc": true, "displayName": "Nombre de pods" } ] }, "pluginVersion": "11.6.1", "repeat": "cluster", "repeatDirection": "h", "targets": [ { "editorMode": "code", "expr": "sum by (namespace) (kube_pod_owner{cluster=\"$cluster\", namespace=~\"rhdh-team.*\"})", "format": "table", "instant": true, "legendFormat": "{{namespace}}", "refId": "A" }, { "datasource": { "type": "prometheus", "uid": "000000001" }, "editorMode": "code", "expr": "max by (namespace) (catalog_entities_count{kind=\"user\", cluster=\"$cluster\", namespace=~\"rhdh-team.*\"})", "format": "table", "hide": false, "instant": true, "legendFormat": "{{namespace}}", "refId": "B" }, { "datasource": { "type": "prometheus", "uid": "000000001" }, "editorMode": "code", "expr": "max by (namespace) (catalog_entities_count{kind=\"template\", cluster=\"$cluster\", namespace=~\"rhdh-team.*\"})", "format": "table", "hide": false, "instant": true, "legendFormat": "{{namespace}}", "refId": "C" }, { "datasource": { "type": "prometheus", "uid": "000000001" }, "editorMode": "code", "expr": "max by (namespace) (catalog_entities_count{kind=\"component\", cluster=\"$cluster\", namespace=~\"rhdh-team.*\"})", "format": "table", "hide": false, "instant": true, "legendFormat": "{{namespace}}", "refId": "D" } ], "title": "Métriques RHDH (rhdh-team)", "transformations": [ { "id": "organize", "options": { "excludeByName": { "Time": true }, "includeByName": {}, "indexByName": {}, "renameByName": { "Namespace": "Namespace", "Nombre de pods": "Nombre de pods", "Value": "Nombre de pods", "namespace": "Namespace" } } }, { "id": "joinByField", "options": { "byField": "Namespace", "mode": "outer" } } ], "type": "table" } ], "preload": false, "schemaVersion": 41, "tags": [], "templating": { "list": [ { "current": { "text": "atlantis", "value": "atlantis" }, "definition": "label_values(acm_managed_cluster_labels,name)", "includeAll": false, "name": "cluster", "options": [], "query": { "qryType": 1, "query": "label_values(acm_managed_cluster_labels,name)", "refId": "PrometheusVariableQueryEditor-VariableQuery" }, "refresh": 1, "regex": "", "type": "query" }, { "current": { "text": [ "$__all" ], "value": [ "$__all" ] }, "includeAll": true, "label": "Team", "multi": true, "name": "team", "options": [ { "selected": false, "text": "team1", "value": "team1" }, { "selected": false, "text": "team2", "value": "team2" }, { "selected": false, "text": "team3", "value": "team3" }, { "selected": false, "text": "team4", "value": "team4" }, { "selected": false, "text": "team5", "value": "team5" } ], "query": "team1, team2, team3, team4, team5", "type": "custom" } ] }, "time": { "from": "now-6h", "to": "now" }, "timepicker": {}, "timezone": "browser", "title": "Open Code Quest", "uid": "85ad6a7d95edbf8ccd2f32869a3eac3a", "version": 64 }